## 一、系统定位与核心目标

**系统定位：**  
本地运行的个人财务分析 Web 系统，偏分析与复盘，不是单纯记账本。

**核心目标：**

- **高频快速记账：**5–10 秒记完一笔，电脑端操作顺手。
- **精细消费结构分析：**按类别、标签、时间维度看清钱花在哪。
- **行为模式识别：**发现异常消费、长期偏科、冲动消费等。
- **AI 月度复盘：**每月自动生成一份“财务教练式”分析报告。
- **轻资产视角：**不精确盘点账户余额，重点看净现金流与趋势。

---

## 二、功能模块总览

### 1. 记账模块（交易录入）

**目标：**让你在 5–10 秒内记完一笔。

**功能清单：**

- **快速录入表单：**
  - 金额（必填）
  - 类型：收入 / 支出（默认支出）
  - 日期（默认今天，可改）
  - 类别（支持子类别）
  - 标签（从预设列表选，可新增）
  - 支付方式：微信 / 支付宝亲密付 / 银行卡
  - 备注（可选，一句话）

- **交互要求：**
  - 尽量单页完成，不跳转
  - 键盘操作友好（回车提交、Tab 切换）
  - 提交后表单自动重置，准备下一笔

---

### 2. 数据结构设计（核心表）

#### 2.1 交易表 `transactions`

- **id**
- **amount**（金额，正数）
- **type**（income / expense）
- **date**（日期）
- **category_main**（主类别：餐饮 / 学习 / 娱乐 / 交通 / 生活 / 人际 / 健康 / 其他）
- **category_sub**（子类别：如 外卖 / 食堂 / 奶茶 / 书籍 / 游戏 等）
- **tags**（数组：冲动 / 刚需 / 投资自己 / 社交压力 / 情绪消费 / 宿舍 / 校外 / 旅行 / 约会 …）
- **payment_method**（wechat / alipay_family / bank）
- **note**（备注）
- **created_at**（记录创建时间）

#### 2.2 预算表 `budgets`

- **id**
- **month**（2025-02 这种）
- **total_budget**（本月总预算）
- **category_main**（可为空，表示总预算；不为空表示某一类预算）
- **budget_amount**
- **auto_stats**（后端计算：本月该类实际支出）
- **status**（正常 / 接近 / 超支）

#### 2.3 标签配置表 `tags_config`（可选）

- **id**
- **name**（如“冲动消费”）
- **type**（性质 / 场景）
- **description**（可选）

> 你可以先不做配置表，直接在前端写死一批默认标签，后面再抽出来。

---

### 3. 仪表盘与可视化模块

#### 3.1 首页仪表盘

**首页展示内容：**

- **本月总支出 / 总收入 / 结余**
- **今日支出**
- **本月前三大消费类别（主类别）**
- **情绪灯：**
  - 绿：本月支出在合理区间
  - 黄：接近预算或明显高于历史平均
  - 红：超预算或异常高

**图表：**

- 本月每日支出折线图
- 本月各类别支出占比饼图

---

#### 3.2 分析页面

**按月分析：**

- 任意选择一个月份：
  - 总支出 / 总收入 / 结余
  - 各类别支出金额 + 占比
  - 冲动消费总金额（标签包含“冲动”）
  - 学习投资总金额（标签包含“投资自己”“学习投资”）

**按类别分析：**

- 选择一个主类别（如“餐饮”）：
  - 最近 3 个月该类支出趋势
  - 该类在总支出中的占比变化

**按标签分析：**

- 冲动消费趋势
- 情绪消费趋势
- 学习投资趋势

---

### 4. 行为模式识别模块（规则引擎）

先用简单规则，不上机器学习：

- **异常高支出日：**
  - 某天支出 > 本月日均支出 × 阈值（比如 2 倍）
- **长期高占比类别：**
  - 某类别连续 3 个月占比 > 30%（阈值可调）
- **冲动消费预警：**
  - 本月“冲动”标签金额 / 总支出 > 某比例
- **学习投资不足：**
  - 本月“学习投资”金额 / 总支出 < 某比例

这些结果会在：

- 分析页面展示
- 提供给 AI 复盘使用

---

### 5. 预算模块（基础 + 进阶）

**基础版：**

- 设置：
  - 每月总预算
  - 各主类别预算（可选）
- 展示：
  - 实际支出 vs 预算
  - 执行率（百分比）

**进阶版：**

- 接近预算提醒：
  - 某类支出 > 预算的 80% → 标黄
  - 超预算 → 标红
- 分析：
  - 哪些类别导致超支
  - 本月预算设置是否合理（结合历史数据）

---

### 6. AI 月度复盘模块

#### 6.1 数据准备

每月生成一份“AI 输入数据包”，包含：

- 本月总收入 / 总支出 / 结余
- 各类别支出金额 + 占比
- 各标签支出金额（尤其是：冲动 / 情绪 / 学习投资）
- 行为模式识别结果：
  - 异常高支出日列表
  - 长期高占比类别
  - 冲动消费比例
  - 学习投资比例

你只需要在页面上一键复制这段 JSON / 文本，丢给 AI。

#### 6.2 AI 输出预期结构

- 本月消费结构总结
- 本月消费习惯分析
- 值得肯定的地方
- 需要警惕的地方
- 下月具体建议（可执行）

> 以后你也可以把这部分做成“系统内置提示词模板”，每月点一下就生成。

---

## 三、页面结构设计

1. **首页 / 仪表盘**
   - 本月关键数据 + 图表 + 情绪灯

2. **记账页面**
   - 快速录入表单
   - 最近几笔记录列表（方便检查）

3. **分析页面**
   - 月度分析
   - 类别分析
   - 标签分析
   - 行为模式提示区

4. **预算设置页面**
   - 设置/修改预算
   - 查看预算执行情况

5. **AI 复盘页面**
   - 本月数据摘要
   - 一键复制“AI 输入数据包”
   - 可粘贴 AI 输出做存档（形成“成长时间轴”）

---

## 四、开发优先级建议（MVP 路线）

**第一阶段（MVP，可用版）：**

- 交易表 + 快速记账页面
- 首页：本月总支出 / 总收入 / 结余 + 简单图表
- 月度分析：按类别统计
- 手动复制数据给 AI 复盘

**第二阶段（增强版）：**

- 标签分析
- 行为模式识别规则
- 预算模块基础版
- 更丰富的图表

**第三阶段（进阶版）：**

- 情绪灯逻辑完善
- 预算进阶分析
- AI 复盘页面模板化
- 导出数据（可选）